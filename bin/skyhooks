#!/usr/bin/env ruby
# skyhooks

# 20210604
# 0.0.2

require 'Array/match'
require 'File/grep'

RAILS_EXCLUSIONS = [
  /spec_helper/,
  /helpers/,
  /factories/,
  /support/
]

def dir
  File.expand_path(ARGV[0]) || '.'
end

def test_filenames
  Dir.glob("#{dir}/**/*.rb").select do |filename|
    RAILS_EXCLUSIONS.match(filename).empty?
  end
end

def main
  test_filenames.each do |test_filename|
    p test_filename
    p File.new(test_filename).grep(/FactoryBot\.build/)
  end
end

main
